\section{Semantics}

\begin{frame}
    \frametitle{Interpretation}

    Values are interpreted in a \alert{lattice} \(\values\):

    \begin{minipage}{0.49\textwidth}
        \[
            \tikzfig{circuits/a4}
        \]
    \end{minipage}
    \begin{minipage}{0.49\textwidth}
        \begin{align*}
            \tikzfig{circuits/components/values/false} 
            \,&\mapsto\, 0 \\
            \tikzfig{circuits/components/values/true} 
            \,&\mapsto\, 1 \\
            \tikzfig{strings/structure/monoid/init} 
            \,&\mapsto\, \bot \\
            \tikzfig{strings/structure/monoid/init-white} 
            \,&\mapsto\, \top \\
        \end{align*}
    \end{minipage}
\end{frame}

\begin{frame}
    \frametitle{Interpretation}

    \setlength{\tabcolsep}{1em}
    \renewcommand{\arraystretch}{2}

    \begin{center}
        \begin{tabular}{ll}
            \tikzfig{circuits/components/gates/gate} & \alert{monotone functions} \(\morph{\overline{g}}{\valuetuple{m}}{\values}\) \\ \pause
            \tikzfig{strings/structure/comonoid/copy} & \alert{copy} \(x \mapsto (x, x)\) \\ \pause
            \tikzfig{strings/structure/monoid/merge} & \alert{join in the lattice} \((x, y) \mapsto x \ljoin y\) \\ \pause
            \tikzfig{strings/structure/comonoid/discard} & \alert{discard} \(x \mapsto \bullet\)
        \end{tabular}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Stream functions}

    The semantics of circuits is that of \alert{stream functions}.

    \pause

    A \alert{stream} \(\stream{\values}\) is an infinite sequence of values.
    
    \pause
    
    A \alert{stream function} \(\morph{f}{\stream{(\valuetuple{m})}}{\stream{(\valuetuple{n})}}\) consumes and produces streams.

    \pause

    For stream \(\sigma\), \(\sigma(i)\) is the \alert{\(i\)th element}.

\end{frame}

\begin{frame}
    \frametitle{Components as streams}

    \setlength{\tabcolsep}{1em}
    \renewcommand{\arraystretch}{2}

    \begin{center}
        \begin{tabular}{cll}
            \tikzfig{circuits/components/values/v} & \pause \(f(\bullet)(0) = v\) & \pause \(f(\bullet)(k+1) = \bot\) \\ \pause
            \tikzfig{circuits/components/gates/gate} & \pause \(f(\sigma)(k) = \overline{g}(\sigma(k))\) &  \\ \pause
            \tikzfig{circuits/components/delay} & \pause \(f(\sigma)(0) = \bot\) & \pause \(f(\sigma)(k+1) = \sigma(k)\)
        \end{tabular}
    \end{center}
    

\end{frame}

\begin{frame}
    \frametitle{Stream functions: example}

        \[
            \morph{f}{\stream{\values}}{\stream{\values}} := \circuittostream[\tikzfig{circuits/examples/simple-and}]{}
        \]

        \vspace{1em}

        \pause
        \[
            f(\sigma)(i) =
            \begin{cases}
                \pause 1 \land \sigma(0) & i = 0 \\
                \pause f(\sigma)(k) \land \sigma(k+1) & i = k+1
                
            \end{cases}
        \]
\end{frame}

\begin{frame}
    \frametitle{Stream functions}

    Not all stream functions correspond to sequential circuits...
    
\end{frame}

\begin{frame}
    \frametitle{Causal stream functions}

    Circuits cannot depend on \alert{future inputs}.

    \pause

    A stream function is \alert{causal} when the \(i\)th element of the output stream can only depend on the first \(i+1\) inputs.

    \pause

    \begin{center}
        \(
            \circuittostream[\tikzfig{circuits/examples/simple-and}]{}
        \)
        \qquad
        \(
            f(\sigma)(i) =
            \begin{cases}
                1 \land \sigma(0) & i = 0 \\
                f(\sigma)(k) \land \sigma(k+1) & i = k+1
                
            \end{cases}
        \)
    \end{center}
\end{frame}


\begin{frame}
    \frametitle{Monotone stream functions}

    Components in circuits are \alert{monotone}.

    A stream function is \alert{monotone} when computing each element of the output stream is a monotone function.

    \begin{center}
        \(
            \circuittostream[\tikzfig{circuits/examples/simple-and}]{}
        \)
        \qquad
        \(
            f(\sigma)(i) =
            \begin{cases}
                1 \land \sigma(0) & i = 0 \\
                f(\sigma)(k) \land \sigma(k+1) & i = k+1
                
            \end{cases}
        \)
    \end{center}

\end{frame}

\begin{frame}
    \frametitle{`Finite' stream functions}

    Circuits contain only a finite number of components.

    A stream function with \alert{finitely many stream derivatives} specifies finite behaviours given some inputs.

    \vspace{1em}

    \begin{center}
        \(
            \circuittostream[\tikzfig{circuits/examples/simple-and}]{}
        \)
        \qquad
        \(
            f(\sigma)(i) =
            \begin{cases}
                1 \land \sigma(0) & i = 0 \\
                f(\sigma)(k) \land \sigma(k+1) & i = k+1
                
            \end{cases}
        \)
        \pause

        \vspace{1.5em}

        \(
            f(0 \streamcons \sigma)(0) = 1 \land 0 = 0
        \)
        \pause

        \(
            f(0 \streamcons \sigma)(1) = f(0 \streamcons \sigma)(0) \land \sigma(0) = 0 \land \sigma(0) = 0
        \)\pause
        
        \(
            f(0 \streamcons \sigma)(2) = f(0 \streamcons \sigma)(1) \land \sigma(1) = 0 \land \sigma(1) = 0 = f(0 :: \sigma)(1)
        \)
    \end{center}

\end{frame}

\begin{frame}
    \frametitle{Stream functions for circuits}
    \begin{theorem}
        Every monotone causal stream function with finitely many stream derivatives corresponds to a class of sequential circuits. 
    \end{theorem}
\end{frame}